<ins>**Bookmaker Accuracy Measurement**</ins>

ðŸŽ¯ In this part we will assess how accurate are the bookmaker predictions as follows:

- As bookmaker predictions I consider the final odds (The odds offered just before the kickoff of each match) from 3 major bookmakers: Pinnacle, Bet365 and William Hill.
This does not mean that the odds are stable throughout their offering, but the fluctuate due to various reasons, sometimes significantly.
This means that this analysis does not measure the performance of the bookmakers in general, it only compares the final snapshot in comparison to the actual results.

- The odds are the perceived probability of the three possible outcomes of a match (each team winning the match & the match ends winnless) plus a pecent of profit margin (overround).

```ruby
#creation of a table containing all the matches across the last 5 seasons along with the final score and odds for the 
#match winner from 3 bookmakers
create table Odds_table

select season20212022.Date AS match_date,Season, HomeTeam, AwayTeam, FTHG, FTAG, FTR, B365H, B365D, B365A, PSH, PSD, PSA, WHH, WHD, WHA
from season20212022
union all 
select season20202021.Date AS match_date,Season, HomeTeam, AwayTeam, FTHG, FTAG, FTR, B365H, B365D, B365A, PSH, PSD, PSA, WHH, WHD, WHA
from season20202021
union all 
select season20192020.Date AS match_date,Season, HomeTeam, AwayTeam, FTHG, FTAG, FTR, B365H, B365D, B365A, PSH, PSD, PSA, WHH, WHD, WHA
from season20192020
union all 
select season20182019.Date AS match_date,Season, HomeTeam, AwayTeam, FTHG, FTAG, FTR, B365H, B365D, B365A, PSH, PSD, PSA, WHH, WHD, WHA
from season20182019
union all 
select season20172018.Date AS match_date,Season, HomeTeam, AwayTeam, FTHG, FTAG, FTR, B365H, B365D, B365A, PSH, PSD, PSA, WHH, WHD, WHA
from season20172018;

# Creation of a second table derived from the above table containing: all the matches, the winning selection, the 
#average odds for the winner of the three bookmakers
create table odds_table_1
select HomeTeam,AwayTeam,FTR,round(((B365H+PSH+WHH)/3),2) AS Home_Average,round(((B365d+PSd+WHd)/3),2) AS Draw_Average,round(((B365a+PSa+WHa)/3),2) AS Away_Average
FROM premierleague.odds_table
Group by HomeTeam;

#Addition of the column with the odds of the winning selection
ALTER TABLE premierleague.odds_table_1
ADD Winning_odds varchar(255);

#Population of the column with the odds depending on the winning selection
UPDATE odds_table_1
SET Winning_odds=case 
when FTR="H" THEN Home_Average
when FTR="D" THEN Draw_Average
ELSE Away_Average
END;
```
This is the dataset we will work on.
